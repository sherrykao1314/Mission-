<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¶…ç´šä»»å‹™å›å ±ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* è‡ªå®šç¾©ä¸€äº›ç´°ç¯€æ¨£å¼ */
        body { background-color: #f0f4f0; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; }
        .card { border-radius: 20px; box-shadow: 0 8px 30px rgba(0,0,0,0.05); }
        /* æŒ‰éˆ•äº’å‹•æ•ˆæœ */
        .btn-green { background-color: #4caf50; transition: all 0.3s ease; }
        .btn-green:hover { background-color: #388e3c; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3); }
        /* ä¸‹æ‹‰é¸å–®æ¨£å¼è‡ªè¨‚ */
        select { -webkit-appearance: none; -moz-appearance: none; appearance: none; background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E"); background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em; }
        /* ç¢ºä¿ iframe åœ¨è¡Œå‹•è£ç½®ä¸Šä¹Ÿèƒ½é †æš¢æ²å‹• */
        .iframe-container { -webkit-overflow-scrolling: touch; }
    </style>
</head>
<body class="p-4 md:p-8 bg-green-50">
    <div class="max-w-4xl mx-auto">
        
        <div class="mb-6">
            <img src="banner2.png" alt="è¶…ç´šä»»å‹™å›å ±å€ Banner" class="w-full rounded-2xl shadow-sm">
        </div>

        <div class="mb-8 text-center">
            <label for="period-select" class="block text-lg font-bold text-green-800 mb-3">è«‹å…ˆé¸æ“‡ä½ çš„æœŸåˆ¥ï¼š</label>
            <div class="relative inline-block w-full md:w-64">
                <select id="period-select" class="block w-full bg-white border-2 border-green-400 hover:border-green-600 px-4 py-3 pr-8 rounded-xl leading-tight focus:outline-none focus:shadow-outline text-gray-700 font-bold text-lg cursor-pointer shadow-sm transition-colors">
                    </select>
            </div>
            <p class="text-gray-500 text-sm mt-2">é¸æ“‡å¾Œï¼Œä¸‹æ–¹çš„å ±è¡¨æœƒè‡ªå‹•æ›´æ–°ç‚ºè©²æœŸåˆ¥è³‡æ–™</p>
        </div>

        <div class="mb-8 flex justify-center">
            <a id="fill-btn" href="#" target="_blank" class="btn-green text-white flex items-center justify-center py-4 px-8 rounded-xl font-bold text-lg group w-full md:w-auto">
                <span class="mr-2">ğŸ“</span> æˆ‘è¦å¡«å¯«ä»Šæ—¥å›å ±
            </a>
        </div>

        <div id="report-view" class="card bg-white p-4 md:p-6">
            <h2 class="text-xl font-bold text-green-700 mb-4 flex items-center">
                <span class="mr-2">ğŸ“…</span> <span id="report-title-period"></span> å›å ±ç¾æ³
            </h2>
            
            <div class="iframe-container overflow-hidden rounded-lg border border-gray-200 h-[600px] relative bg-gray-50">
                <div id="loading-hint" class="absolute inset-0 flex flex-col items-center justify-center text-gray-500 z-10">
                    <svg class="animate-spin h-8 w-8 text-green-500 mb-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span>è³‡æ–™è®€å–ä¸­...</span>
                </div>
                <iframe id="report-frame" class="w-full h-full border-0 relative z-20 opacity-0 transition-opacity duration-300" src=""></iframe>
            </div>
        </div>

        <p class="text-center text-gray-400 text-sm mt-8 mb-4">Â© è¶…ç´šä»»å‹™åœ˜éšŠ Keep Going!</p>
    </div>

    <script>
        // =================================================================
        // è³‡æ–™è¨­å®šå€
        // =================================================================
        
        // çµ±ä¸€çš„ Google è¡¨å–®å¡«å¯«é€£çµ
        const COMMON_FORM_LINK = 'https://forms.gle/nGYhD9F9KB1acrfN7';

        // å„æœŸåˆ¥å°æ‡‰çš„è©¦ç®—è¡¨æª¢è¦–é€£çµ (å·²æ›¿æ›ç‚ºä½ æä¾›çš„é€£çµ)
        const periodLinks = {
            '11402': {
                sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=792683658&single=true&widget=true&headers=false'
            },
            '11403': {
                sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=1092560054&single=true&widget=true&headers=false'
            },
            '11404': {
                sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=1264019522&single=true&widget=true&headers=false'
            },
            '11405': {
                sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=1216376166&single=true&widget=true&headers=false'
            },
            '11406': {
                sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=158979238&single=true&widget=true&headers=false'
            },
            '11407': {
                sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=1789461878&single=true&widget=true&headers=false'
            },
            '11408': {
                sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=73357386&single=true&widget=true&headers=false'
            },
            '11409': {
                sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=1834863180&single=true&widget=true&headers=false'
            },
            '11410': {
                sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=534608037&single=true&widget=true&headers=false'
            },
            '11411': {
                sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=537038905&single=true&widget=true&headers=false'
            },
            '11412': {
                sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=500900643&single=true&widget=true&headers=false'
            }
        };
        // =================================================================

        // å–å¾— DOM å…ƒç´ 
        const periodSelect = document.getElementById('period-select');
        const fillBtn = document.getElementById('fill-btn');
        const reportFrame = document.getElementById('report-frame');
        const reportTitlePeriod = document.getElementById('report-title-period');
        const loadingHint = document.getElementById('loading-hint');

        // 1. åˆå§‹åŒ–ä¸‹æ‹‰é¸å–®é¸é …
        Object.keys(periodLinks).forEach(period => {
            const option = document.createElement('option');
            option.value = period;
            option.textContent = `${period} æœŸ`;
            periodSelect.appendChild(option);
        });

        // 2. å®šç¾©æ›´æ–°é€£çµèˆ‡ç•«é¢çš„å‡½å¼
        function updateLinks() {
            const selectedPeriod = periodSelect.value;
            const links = periodLinks[selectedPeriod];

            if (links) {
                // é¡¯ç¤ºè¼‰å…¥ä¸­æç¤ºï¼Œéš±è— iframe
                loadingHint.style.display = 'flex';
                reportFrame.style.opacity = '0';
                
                // æ›´æ–°æŒ‰éˆ•é€£çµ (æ‰€æœ‰æœŸåˆ¥éƒ½ä½¿ç”¨åŒä¸€å€‹è¡¨å–®é€£çµ)
                fillBtn.href = COMMON_FORM_LINK;
                
                // æ›´æ–°è©¦ç®—è¡¨é€£çµ
                // é€™è£¡åŠ ä¸€å€‹å°æŠ€å·§ï¼šåŠ ä¸Šæ™‚é–“æˆ³è¨˜åƒæ•¸ï¼Œé¿å…ç€è¦½å™¨å¿«å–èˆŠè³‡æ–™
                const timestamp = new Date().getTime();
                reportFrame.src = links.sheetLink + "&t=" + timestamp;
                
                // æ›´æ–°æ¨™é¡Œæ–‡å­—
                reportTitlePeriod.textContent = selectedPeriod + " æœŸ";
            }
        }

        // 3. ç›£è½ iframe è¼‰å…¥å®Œæˆäº‹ä»¶
        reportFrame.onload = function() {
            // éš±è—è¼‰å…¥æç¤ºï¼Œé¡¯ç¤º iframe
            loadingHint.style.display = 'none';
            reportFrame.style.opacity = '1';
        };

        // 4. ç›£è½é¸å–®è®Šæ›´äº‹ä»¶
        periodSelect.addEventListener('change', updateLinks);

        // 5. é é¢è¼‰å…¥æ™‚å…ˆåŸ·è¡Œä¸€æ¬¡ï¼Œä»¥è¼‰å…¥é è¨­é¸é …çš„é€£çµ
        updateLinks();

    </script>
</body>
</html>
