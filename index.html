<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¶…ç´šä»»å‹™å›å ±ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ã€æ–°å¢ã€‘å…¨åŸŸå¹³æ»‘æ²å‹•ï¼Œæ¸›å°‘çªå…€çš„è·³å‹•æ„Ÿ */
        html { scroll-behavior: smooth; }
        
        /* è‡ªå®šç¾©æ¨£å¼ */
        body { background-color: #f0f4f0; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; }
        .card { border-radius: 20px; box-shadow: 0 8px 30px rgba(0,0,0,0.05); }
        /* æŒ‰éˆ•äº’å‹•æ•ˆæœ */
        .btn-green { background-color: #4caf50; transition: all 0.3s ease; }
        .btn-green:hover { background-color: #388e3c; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3); }
        /* ä¸‹æ‹‰é¸å–®æ¨£å¼è‡ªè¨‚ */
        select { -webkit-appearance: none; -moz-appearance: none; appearance: none; background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E"); background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em; }
        /* ç¢ºä¿ iframe åœ¨è¡Œå‹•è£ç½®ä¸Šä¹Ÿèƒ½é †æš¢æ²å‹• */
        .iframe-container { -webkit-overflow-scrolling: touch; }
    </style>
</head>
<body class="p-4 md:p-8 bg-green-50">
    <div class="max-w-4xl mx-auto">
        
        <div class="mb-6">
            <img src="banner2.png" alt="è¶…ç´šä»»å‹™å›å ±å€ Banner" class="w-full rounded-2xl shadow-sm">
        </div>

        <div class="mb-6 text-center">
            <div class="relative inline-block w-full md:w-72">
                <select id="period-select" class="block w-full bg-white border-2 border-green-400 hover:border-green-600 px-4 py-3 pr-8 rounded-xl leading-tight focus:outline-none focus:shadow-outline text-gray-700 font-bold text-lg cursor-pointer shadow-sm transition-colors">
                    </select>
            </div>
        </div>

        <div class="mb-8 flex justify-center">
            <a id="fill-btn" href="javascript:void(0);" target="_blank" class="btn-green text-white flex items-center justify-center py-4 px-8 rounded-xl font-bold text-lg group w-full md:w-auto shadow-md">
                <span class="mr-2">ğŸ“</span> æˆ‘è¦å¡«å¯«ä»Šæ—¥å›å ±
            </a>
        </div>

        <div id="rewards-section" class="card bg-white p-6 md:p-8 mb-8 text-center">
            <h2 class="text-2xl font-bold text-green-700 mb-6 flex items-center justify-center">
                <span class="mr-2">ğŸ</span> è¶…ç´šä»»å‹™çå‹µæ–¹æ¡ˆ
            </h2>
            
            <div class="bg-gray-100 border-2 border-dashed border-gray-300 rounded-xl h-64 flex items-center justify-center text-gray-500 mb-6">
                (çå‹µæ–¹æ¡ˆæµ·å ±å³å°‡å…¬å¸ƒï¼Œæ•¬è«‹æœŸå¾…ï¼)
            </div>
            <div class="border-t pt-6">
                <p class="text-gray-600 mb-4 font-bold">ğŸ“Œ ä»»å‹™å¿…å‚™å·¥å…·ä¸‹è¼‰ï¼š</p>
                <div class="flex flex-col md:flex-row justify-center gap-4">
                    <a href="è¶…ç´šä»»å‹™å•å·.pdf" download class="inline-flex items-center justify-center bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg transition-colors shadow hover:shadow-md">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                        ä¸‹è¼‰å•å· PDF
                    </a>
                    <a href="script.html" target="_blank" class="inline-flex items-center justify-center bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-6 rounded-lg transition-colors shadow hover:shadow-md">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                        å•å·ä½¿ç”¨è©±è¡“åƒè€ƒ
                    </a>
                </div>
            </div>
        </div>

        <div id="report-view" class="card bg-white p-4 md:p-6 hidden">
            <h2 class="text-xl font-bold text-green-700 mb-4 flex items-center">
                <span class="mr-2">ğŸ“…</span> <span id="report-title-period"></span> å›å ±ç¾æ³
            </h2>
            
            <div class="iframe-container rounded-lg border border-gray-200 h-[600px] relative bg-gray-50">
                <div id="loading-hint" class="absolute inset-0 flex flex-col items-center justify-center text-gray-500 z-10 bg-gray-50">
                    <svg class="animate-spin h-8 w-8 text-green-500 mb-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span>è³‡æ–™è®€å–ä¸­...</span>
                </div>
                <iframe id="report-frame" class="w-full h-full border-0 relative z-20 opacity-0 transition-opacity duration-300" src=""></iframe>
            </div>
        </div>

        <p class="text-center text-gray-400 text-sm mt-8 mb-4">Â© è¶…ç´šä»»å‹™åœ˜éšŠ Keep Going!</p>
    </div>

    <script>
        // =================================================================
        // è³‡æ–™è¨­å®šå€ (ä¿æŒä¸è®Š)
        // =================================================================
        const COMMON_FORM_LINK = 'https://forms.gle/nGYhD9F9KB1acrfN7';
        const periodLinks = {
            '11402': { sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=792683658&single=true&widget=true&headers=false' },
            '11403': { sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=1092560054&single=true&widget=true&headers=false' },
            '11404': { sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=1264019522&single=true&widget=true&headers=false' },
            '11405': { sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=1216376166&single=true&widget=true&headers=false' },
            '11406': { sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=158979238&single=true&widget=true&headers=false' },
            '11407': { sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=1789461878&single=true&widget=true&headers=false' },
            '11408': { sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=73357386&single=true&widget=true&headers=false' },
            '11409': { sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=1834863180&single=true&widget=true&headers=false' },
            '11410': { sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=534608037&single=true&widget=true&headers=false' },
            '11411': { sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=537038905&single=true&widget=true&headers=false' },
            '11412': { sheetLink: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR851tFX3xUDd3-Al9509wopMIuNCraXyx6sdCEVIUIiCHlswrgmyrjwzpcC7_-MK7ScZdnyjURLk_t/pubhtml?gid=500900643&single=true&widget=true&headers=false' }
        };
        // =================================================================

        const periodSelect = document.getElementById('period-select');
        const fillBtn = document.getElementById('fill-btn');
        const rewardsSection = document.getElementById('rewards-section');
        const reportView = document.getElementById('report-view');
        const reportFrame = document.getElementById('report-frame');
        const reportTitlePeriod = document.getElementById('report-title-period');
        const loadingHint = document.getElementById('loading-hint');

        // 1. åˆå§‹åŒ–ä¸‹æ‹‰é¸å–®
        const defaultOption = document.createElement('option');
        defaultOption.value = "";
        defaultOption.textContent = "-- è«‹é¸æ“‡æœŸåˆ¥æŸ¥çœ‹å ±è¡¨ --";
        periodSelect.appendChild(defaultOption);

        Object.keys(periodLinks).forEach(period => {
            const option = document.createElement('option');
            option.value = period;
            option.textContent = `${period} æœŸ`;
            periodSelect.appendChild(option);
        });

        // 2. å®šç¾©æ›´æ–°ç•«é¢çš„å‡½å¼
        function updateViewState(isInitialLoad = false) {
            const selectedPeriod = periodSelect.value;
            
            // æ›´æ–°å¡«å¯«æŒ‰éˆ•é€£çµ
            if (selectedPeriod !== "") {
                 fillBtn.href = COMMON_FORM_LINK;
            } else {
                 fillBtn.href = "javascript:void(0);";
            }

            if (selectedPeriod === "") {
                rewardsSection.classList.remove('hidden');
                reportView.classList.add('hidden');
            } else {
                rewardsSection.classList.add('hidden');
                reportView.classList.remove('hidden');
                
                // ã€é—œéµä¿®æ”¹ã€‘ç•¶é¸æ“‡æœŸåˆ¥æ™‚ï¼Œå¼·åˆ¶ç€è¦½å™¨å¹³æ»‘æ²å‹•åˆ°å ±è¡¨å€å¡Š
                // é€™å¯ä»¥å°æŠ— iframe è¼‰å…¥æ™‚é€ æˆçš„è·³å‹•
                if (!isInitialLoad) {
                    setTimeout(() => {
                        reportView.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }, 100); // çµ¦äºˆä¸€é»é»å»¶é²ç¢ºä¿å€å¡Šå·²é¡¯ç¤º
                }

                loadReportData(selectedPeriod);
            }
        }

        // è¼‰å…¥å ±è¡¨è³‡æ–™çš„è¼”åŠ©å‡½å¼
        function loadReportData(period) {
            const links = periodLinks[period];
            if (links) {
                loadingHint.style.display = 'flex';
                // é€™è£¡æš«æ™‚ä¸éš±è— iframeï¼Œé¿å… iOS ä¸Šé‡æ–°é¡¯ç¤ºæ™‚çš„é–ƒçˆå’Œè·³å‹•
                // reportFrame.style.opacity = '0'; 
                
                const timestamp = new Date().getTime();
                // æª¢æŸ¥æ˜¯å¦å·²ç¶“æ˜¯åŒä¸€å€‹é€£çµï¼Œé¿å…é‡è¤‡è¼‰å…¥
                const newSrc = links.sheetLink + "&t=" + timestamp;
                if (reportFrame.src.split('&t=')[0] !== links.sheetLink) {
                    reportFrame.src = newSrc;
                } else {
                    // å¦‚æœæ˜¯åŒä¸€å€‹é€£çµï¼Œæ‰‹å‹•è§¸ç™¼ onload ä»¥éš±è—æç¤º
                     loadingHint.style.display = 'none';
                }
                
                reportTitlePeriod.textContent = period + " æœŸ";
            }
        }

        // 3. ç›£è½ iframe è¼‰å…¥å®Œæˆäº‹ä»¶
        reportFrame.onload = function() {
            loadingHint.style.display = 'none';
            reportFrame.style.opacity = '1';
        };

        // 4. ç›£è½é¸å–®è®Šæ›´äº‹ä»¶
        periodSelect.addEventListener('change', () => updateViewState(false));

        // 5. é é¢è¼‰å…¥æ™‚åŸ·è¡Œä¸€æ¬¡ (å‚³å…¥ true ä»£è¡¨æ˜¯åˆå§‹è¼‰å…¥ï¼Œä¸éœ€è¦æ²å‹•)
        updateViewState(true);

    </script>
</body>
</html>
